### Arguments: Namespace(model_name='llava', coco_dir='../UMDCollab/COCO', cache_path='../UMDCollab/cache', save_projector_dir='./projector/models2', embeddings_dir='./projector/embeddings', save_emb_batch_size=64, batch_size=8, lr=0.001, epochs=10, online_training=True, seed=42, debug=False) ###
### Starting projector training... ###
### Loading llava ###
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  9.91it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 31.36it/s]
### Loading CLIP model ###
Traceback (most recent call last):
  File "/data/gpfs/projects/punim2198/Aryan/hallucination-attack/train_projector.py", line 253, in <module>
    train_transformer(args)
  File "/data/gpfs/projects/punim2198/Aryan/hallucination-attack/train_projector.py", line 76, in train_transformer
    optimizer = torch.optim.AdamW(decoder.parameters(), lr=1e-3)
                                  ^^^^^^^
UnboundLocalError: cannot access local variable 'decoder' where it is not associated with a value
Job ID           : 12567422
Cluster          : spartan
User/Project     : ayazdanparas/punim2198
Nodes            : 1
Wall-clock time  : 00:00:30 / 04:00:00

Displaying overall resources usage from 2025-07-07 20:30:19 to 2025-07-07 20:30:49:

NODE            CPU#        TOT%   ( USR   / SYS   / WIO   / IDLE  ) 

spartan-gpgpu128 : 
                CPU# 1    : 40.9   (  26.0 /  14.9 /   0.0 /  59.1 ) 

                            UTIL%   MEM-USG-AVG  MEM-USG-MAX  TOT-MEM   
                GPU# 1    : 8.7      5114.7M      5114.7M     81920.0M 


Allocated CPUs            : 1    
  CPUs with usage <25%    : 0    
  CPUs with usage <50%    : 1    
  CPUs with usage >50%    : 0    


Allocated GPUs            : 1    
  GPUs with usage <25%    : 1    
  GPUs with usage <50%    : 0    
  GPUs with usage >50%    : 0    

Memory used (RAM)         : 0.0%  [3MB of 85900MB]

--------------------------------------------

